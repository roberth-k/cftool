Version: "1.0"

Global:
  Constants:
    LiveAccountId: "111111111111"
    TestAccountId: "222222222222"
    Some: "bax"

Tenants:
  - Name: live
    Label: MyService EU (live)
    Default:
      Region: eu-west-1
      AccountId: "{{.Constants.LiveAccountId}}"
      Protected: true
    Tags:
      Env: live
  - Name: live-us
    Label: MyService US (live)
    Default:
      Region: us-west-1
      AccountId: "{{.Constants.LiveAccountId}}"
      Protected: true
    Tags:
      Env: live
      Bar: "{{.Constants.Some}}"
  - Name: test
    Label: MyService EU (test)
    Constants:
      Some: const
    Default:
      Region: eu-west-1
      AccountId: "{{.Constants.TestAccountId}}"
    Tags:
      Env: test
      Bar: "{{.Constants.Some}}"

Stacks:
  - Name: mystack
    Label: My Stack
    Default:
      Template: testdata/templates/mystack.yml
      Parameters:
        - File: "testdata/stacks/{{.Tenant.Name}}/{{.Stack.Region}}/{{.Stack.StackName}}.json"
        - Key: Environment
          Value: "{{.Tags.Env}}"
        - Key: SomeConst
          Value: "{{.Tags.Bar}}"
      StackName: "{{.Tags.Env}}-mystack"
    Targets:
      - Tenant: live
      - Tenant: live-us
        Override:
          StackName: "{{.Tags.Env}}-mystack-us"
      - Tenant: test
